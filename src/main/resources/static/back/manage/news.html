<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
        <title>【笔趣阁】——后台管理系统</title>
        <meta content="Admin Dashboard" name="description" />
        <meta content="Mannatthemes" name="author" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <link rel="shortcut icon" href="../assets/images/favicon.ico">
		<link rel="stylesheet" href="../../css/center/index.6b94b.css" />
        <link href="../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
        <link href="../assets/css/icons.css" rel="stylesheet" type="text/css">
        <link href="../assets/css/style.css" rel="stylesheet" type="text/css">

    </head>


    <body class="fixed-left">
<div id="findInformation">
        
        <!-- Loader -->
        <div id="preloader"><div id="status"><div class="spinner"></div></div></div>

        <!-- Begin page -->
        <div id="wrapper">

            <!-- ========== Left Sidebar Start ========== -->
            <div class="left side-menu">
                <button type="button" class="button-menu-mobile button-menu-mobile-topbar open-left waves-effect">
                    <i class="ion-close"></i>
                </button>

                <!-- LOGO -->
                <div class="topbar-left">
                    <div class="text-center">
                        <a href="index.html" class="logo"><i class="mdi mdi-assistant"></i> Weread</a>
                        <!-- <a href="index.html" class="logo"><img src="../assets/images/logo.png" height="24" alt="logo"></a> -->
                    </div>
                </div>

                <div class="sidebar-inner slimscrollleft">

                    <div id="sidebar-menu">
                        <ul>

                            <li>
                                <a href="index.html" class="waves-effect"><i class="mdi mdi-airplay"></i><span>首页</span></a>
                            </li>
                            <li>
                                <a href="usermanage.html" class="waves-effect"><i class="mdi mdi-swap-horizontal"></i><span> 用户管理</span></a>
                            </li>
                            <li>
                                <a href="bookManage.html" class="waves-effect"><i class="mdi mdi-wallet"></i><span> 书籍管理 </span></a>
                            </li>
                            <li>
                                <a href="news.html" class="waves-effect"><i class="mdi mdi-chart-areaspline"></i><span> 反馈信息</span></a>
                            </li>                           
                            <li>
                                <a href="checkVisit.html" class="waves-effect"><i class="mdi mdi-settings"></i><span> 阅读统计 </span></a>
                            </li>
                            <li>
                                <a href="checkVisit.html" class="waves-effect"><i class="mdi mdi-settings"></i><span> 修改密码 </span></a>
                            </li>
                            <li>
                                <a href="logout.html" class="waves-effect"><i class="mdi mdi-power"></i><span> 退出 </span></a>
                            </li>
                            
                        </ul>
                    </div>
                    <div class="clearfix"></div>
                </div> <!-- end sidebarinner -->
            </div>
            <!-- Left Sidebar End -->

            <!-- Start right Content here -->

            <div class="content-page">
                <!-- Start content -->
                <div class="content">

                    <!-- Top Bar Start -->
                    <div class="topbar">

                        <nav class="navbar-custom">

                            <ul class="list-inline float-right mb-0">
                                
                                <li class="list-inline-item dropdown 通知-list">
                                    <a class="nav-link dropdown-toggle arrow-none waves-effect nav-user" data-toggle="dropdown" href="#" role="button"
                                       aria-haspopup="false" aria-expanded="false">
                                        <img src="../assets/images/users/avatar-1.jpg" alt="user" class="rounded-circle">
                                    </a>
                                    <div class="dropdown-menu dropdown-menu-right 个人资料-dropdown ">
                                        <!-- item-->
                                        <div class="dropdown-item noti-title">
                                            <h5>欢迎</h5>
                                        </div>
                                        <a class="dropdown-item" href="index.html"><i class="mdi mdi-account-circle m-r-5 text-muted"></i> 个人资料</a>
                                        <a class="dropdown-item" href="bookManage.html"><i class="mdi mdi-wallet m-r-5 text-muted"></i> 书籍管理</a>
                                        <a class="dropdown-item" href="news.html"><span class="badge badge-success float-right"></span><i class="mdi mdi-settings m-r-5 text-muted"></i> 反馈信息</a>
                                        
                                        <div class="dropdown-divider"></div>
                                        <a class="dropdown-item" href="logout.html"><i class="mdi mdi-登出 m-r-5 text-muted"></i> 登出</a>
                                    </div>
                                </li>

                            </ul>

                            <ul class="list-inline menu-left mb-0">
                                <li class="float-left">
                                    <button class="button-menu-mobile open-left waves-light waves-effect">
                                        <i class="mdi mdi-menu"></i>
                                    </button>
                                </li>
                                
                            </ul>

                            <div class="clearfix"></div>

                        </nav>

                    </div>
                    <!-- Top Bar End -->

                    <div class="page-content-wrapper ">

                        <div class="container-fluid">

                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="page-title-box">
                                        <div class="btn-group float-right">
                                            <ol class="breadcrumb hide-phone p-0 m-0">
                                                <li class="breadcrumb-item"><a href="#">首页</a></li>
                                                <li class="breadcrumb-item active"> 反馈信息</li>
                                            </ol>
                                        </div>
                                        <h4 class="page-title">最新反馈信息</h4>
                                    </div>
                                </div>
                            </div>
                            <!-- end page title end breadcrumb -->
                            <div class="row">
                                <div class="col-md-6 col-xl-4 ">
                                  <div class="card m-b-30">                                
                                            <div class="card-body new-user" style="height: 285px;">
                                                <h5 class="header-title mb-4 mt-0">反馈信息</h5>
                                                <div class="table-responsive">
                                                    <table class="table table-hover mb-0">
                                                        <thead>
                                                            <tr>
                                                                <th class="border-top-0">反馈者</th>
                                                                <th class="border-top-0">类型</th>                                    
                                                                <th class="border-top-0">时间</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>

                                                            <tr v-for="(f,index) in feedBack " @click="getFeedBack(index)">
                                                                <td>{{f.uname}}</td>
                                                                <td>{{f.title}}</td>
                                                                <td>
                                                                    {{f.wtime}}
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                    
                                                </div>
                                            </div>
                                    
                                </div>
                                </div> <!-- end col -->
                                <div class="col-md-6 col-xl-4 ">
                                    <div class="card m-b-30">                                
                                            <div class="card-body new-user" style="height: 285px;">
                                                <h5 class="header-title mb-4 mt-0">通知公告</h5>
                                                <div class="table-responsive">
                                                    <table class="table table-hover mb-0">
                                                        <thead>
                                                            <tr>
                                                                <th class="border-top-0">发布人</th>
                                                                <th class="border-top-0">通知类型</th>                                    
                                                                <th class="border-top-0">时间</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr v-for="(i,index) in infos" @click="showInfo(index)">
                                                                <td>{{i.vname}}</td>
                                                                <td>{{i.itype}}</td>
                                                                
                                                                <td>
                                                                    	{{i.publishTime}}
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                    
                                                </div>
                                            </div>
                                    
                                </div>
                                </div> <!-- end col -->
                                <div class="col-md-6 col-xl-4 ">
                                    <div class="card m-b-30">
                                        <div class="card-body">
                                            <!-- 16:9 aspect ratio -->
                                             <h5 class="header-title mb-4 mt-0">发放通知公告</h5>
                                            <div class="embed-responsive embed-responsive-16by9">
                                              <!--
                                              	<iframe class="embed-responsive-item" src="https://www.baidu.com/"></iframe>
                                              -->
                                              <textarea rows="10" placeholder="管理员请添加公告内容" cols="65" style="width: 345px;height: 132px;margin-top: -134px;padding-bottom: 0px;" v-model="feedBackAdmin"> 
                                             	 
                                              </textarea>
                                              <button style="margin-left: 300px;" @click="fA" type="button" class="btn btn-primary btn-sm float-right">发送</button>
                                               <input type="text" placeholder="请输入通知类型" class="form-control" v-model="iType" style="position: absolute;width: 343px;margin-top: -202px;height: 33px;">
                                            </div>
                                        </div>
                                    </div>
                                </div> <!-- end col -->
                            </div> <!-- end row -->

                            <div class="row">
                                <div class="col-md-6 col-xl-4">                                    
                                    <div class="card m-b-30">
                                        <img class="card-img-top img-fluid" src="../assets/images/news/1.jpg" alt="Card image cap">
                                        <div class="card-body">
                                            <h4 class="card-title font-20 mt-0">管理员反馈</h4>
                                            <p class="card-text">管理员对用户进行信息反馈
                                            </p>                                                    
                                            <small class="text-muted"></small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 col-xl-4"> 
                                    <div class="card m-b-30">
                                        <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
                                            <div class="carousel-inner">
                                                <div class="carousel-item active">
                                                <img class="d-block w-100"  src="../assets/images/news/1.jpg" alt="First slide">
                                                </div>
                                                <div class="carousel-item">
                                                <img class="d-block w-100"  src="../assets/images/news/02.jpg" alt="Second slide">
                                                </div>
                                                <div class="carousel-item">
                                                <img class="d-block w-100"  src="../assets/images/news/1.jpg" alt="Third slide">
                                                </div>
                                            </div>
                                            <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                                <span class="sr-only">Previous</span>
                                            </a>
                                            <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                                <span class="sr-only">Next</span>
                                            </a>
                                        </div>
                                        <div class="card-body">
                                            <h4 class="card-title font-20 mt-0">通知公告</h4>
                                            <p class="card-text">可查看管理员添加的通知通告
                                            </p>                                                    
                                            <small class="text-muted"></small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12 col-xl-4"> 
                                    <div class="card m-b-30">
                                        <img class="card-img-top img-fluid" src="../assets/images/news/1.jpg" alt="Card image cap">
                                        <div class="card-body">
                                            <h4 class="card-title font-20 mt-0">管理员添加通告</h4>
                                            <p class="card-text">管理员进行通告通知
                                            </p>                                                    
                                            <small class="text-muted"></small>
                                        </div>
                                    </div>
                                </div>                                
                            </div><!-- end row -->

                        </div><!-- container -->

                    </div> <!-- Page content Wrapper -->

                </div> <!-- content -->

		 <dialog id="showFeedBack" class="ui-dialog-container" style="display: none;">
			<div class="ui-dialog" tabindex="-1" style="width: auto;">
				<a href="javascript:" class="ui-dialog-close">
					<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200">
						<path d=""></path>
					</svg>
				</a>
				<div class="ui-dialog-title">反馈</div>
				<div class="ui-dialog-body">
		            <div class="letter-pop">
		                <form action="/ajax/message/send" method="post" novalidate="novalidate">
		                <input type="hidden" name="_csrfToken" value="Hem839Q8ixolT0HrVTP2fRY9eNVcFWoXerLYfL3U" id="elMsgCsrf">
		                    <h6 class="pop-title">标题</h6>
		                    <div class="ui-input pop-receiver">
		                        <label for="iptMsgPoster" class="receiver-select receiver-user"></label>
		                        <input type="hidden" id="iptMsgSenderId" name="id">
		                        <input type="hidden" id="iptMsgGuId" name="guid">
		                        <input id="iptMsgPoster" v-model="content.title" name="key" autocomplete="off" readonly="true">
		                    </div>
		                    <h6 class="pop-title">内容</h6>
		                    <div class="pop-content ui-textarea-x" style="width:440px;">
		                        <textarea id="forLetterArea" name="content" maxlength="_500_" lang="zh" rows="5" required=""  placeholder="输入内容" readonly="true">{{content.content}}</textarea>
		                        <div class="ui-textarea"></div>
		                        <label for="forLetterArea" class="ui-textarea-count">
		                            <span>0</span>/<span>500</span>
		                        </label>
		                    </div>
		                    <div class="pop-submit">
		                        <input type="button" id="dialogMsgSubmit" class="clip">
		                        <a class="ui-button"  id="close-btn"  href="news.html" onclick="close()">关闭</a>
		                    </div>
		                    <div class="pop-submit" style="   margin-top: -42px;float: right;width: 100px;">
		                        <input type="button" id="dialogMsgSubmit" class="clip" >
		                        <label class="ui-button"  id="close-btn"  for="dialogMsgSubmit" onclick="showSend()" style="    margin-top: 7px;">回复</label>
		                    </div>
		                </form>
		            </div>
        		</div>
        	</div>
        	<div class="ui-dialog-footer"></div>
        </dialog>

        <dialog id="showReply" class="ui-dialog-container" style="display: none; background-color: black">
                    <div class="ui-dialog" tabindex="-1" style="width: auto;">
                        <a href="javascript:" class="ui-dialog-close">
                            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200">
                                <path d=""></path>
                            </svg>
                        </a>
                        <div class="ui-dialog-title">通知</div>
                        <div class="ui-dialog-body">
                            <div class="letter-pop">
                                <form action="/ajax/message/send" method="post" novalidate="novalidate">
                                    <input type="hidden" name="_csrfToken" value="Hem839Q8ixolT0HrVTP2fRY9eNVcFWoXerLYfL3U" id="elMsgCsrf">
                                    <h6 class="pop-title">标题</h6>
                                    <div class="ui-input pop-receiver">
                                        <label for="iptMsgPoster" class="receiver-select receiver-user"></label>
                                        <input type="hidden" id="iptMsgSenderId" name="id">
                                        <input type="hidden" id="iptMsgGuId" name="guid">
                                        <input id="iptMsgPoster" v-model="content.title" name="key" autocomplete="off" readonly="true">
                                    </div>
                                    <h6 class="pop-title">收件人</h6>
                                    <div class="ui-input pop-receiver">
                                        <label for="iptMsgPoster" class="receiver-select receiver-user"></label>
                                        <input type="hidden" id="iptMsgSenderId" name="id">
                                        <input type="hidden" id="iptMsgGuId" name="guid">
                                        <input id="iptMsgPoster"  v-model="content.uname" name="key" autocomplete="off" readonly="true" >
                                    </div>
                                    <h6 class="pop-title">内容</h6>
                                    <div class="pop-content ui-textarea-x" style="width:440px;">
                                        <textarea id="forLetterArea" name="content" maxlength="_500_" lang="zh" rows="5" required=""  placeholder="输入内容" oninput="font_siz()" ></textarea>
                                        <div class="ui-textarea"></div>
                                    </div>
                                    <div class="pop-submit">
                                        <input type="button" id="dialogMsgSubmit" class="clip">
                                        <a class="ui-button"  id="close-btn"   href="news.html" onclick="close()">关闭</a>
                                    </div>
                                    <div class="pop-submit" style="   margin-top: -42px;float: right;width: 100px;">
                                        <input type="button" id="dialogMsgSubmit" class="clip" >
                                        <label class="ui-button"  id="close-btn"  for="dialogMsgSubmit" @click="sendReply()" style="margin-top: 7px;">发送</label>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <div class="ui-dialog-footer"></div>
            </div>
        </dialog>

        <dialog id="showInfos" class="ui-dialog-container" style="display: none; background-color: black">
            <div class="ui-dialog" tabindex="-1" style="width: auto;">
                <a href="javascript:" class="ui-dialog-close">
                    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200">
                        <path d=""></path>
                    </svg>
                </a>
                <div class="ui-dialog-title">通知</div>
                <div class="ui-dialog-body">
                    <div class="letter-pop">
                        <form action="/ajax/message/send" method="post" novalidate="novalidate">
                            <input type="hidden" name="_csrfToken" value="Hem839Q8ixolT0HrVTP2fRY9eNVcFWoXerLYfL3U" id="elMsgCsrf">
                            <h6 class="pop-title">标题</h6>
                            <div class="ui-input pop-receiver">
                                <label for="iptMsgPoster" class="receiver-select receiver-user"></label>
                                <input type="hidden" id="iptMsgSenderId" name="id">
                                <input type="hidden" id="iptMsgGuId" name="guid">
                                <input id="iptMsgPoster" v-model="information.itype" name="key" autocomplete="off" readonly="true">
                            </div>
                            <h6 class="pop-title">内容</h6>
                            <div class="pop-content ui-textarea-x" style="width:440px;">
                                <textarea id="forLetterArea" name="content" maxlength="_500_" lang="zh" rows="5" required=""  placeholder="输入内容" oninput="font_siz()" >{{information.content}}</textarea>
                                <div class="ui-textarea"></div>
                            </div>
                            <div class="pop-submit">
                                <input type="button" id="dialogMsgSubmit" class="clip">
                                <a class="ui-button"  id="close-btn"   href="news.html" onclick="close()">关闭</a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <div class="ui-dialog-footer"></div>
    </div>
        </dialog>
            <footer class="footer">
                    © 2020 Weread 
                </footer>

            </div>
            <!-- End Right content here -->
			</div>
        </div>
        <!-- END wrapper -->


        <!-- jQuery  -->
        <script src="../assets/js/qs.js"></script>
        <script src="../assets/js/vue.js"></script>
        <script src="../assets/js/axios.js"></script>
        <script src="../assets/js/jquery.min.js"></script>
        <script src="../assets/js/popper.min.js"></script>
        <script src="../assets/js/bootstrap.min.js"></script>
        <script src="../assets/js/modernizr.min.js"></script>
        <script src="../assets/js/detect.js"></script>
        <script src="../assets/js/fastclick.js"></script>
        <script src="../assets/js/jquery.slimscroll.js"></script>
        <script src="../assets/js/jquery.blockUI.js"></script>
        <script src="../assets/js/waves.js"></script>
        <script src="../assets/js/jquery.nicescroll.js"></script>
        <script src="../assets/js/jquery.scrollTo.min.js"></script>

        <!-- App js -->
        <script src="../assets/js/app.js"></script>
        
        
		 <script type="text/javascript">
		 function font_siz() {
			    var num = $("#text_intro").val().length;
			    if(num<140){
			       
			   		$(".num").text(num);
			        
			    }else{
			         
			        $(".num").text(Math.abs(num));
			    }
			 	
			}
		 
		 function showSend(){
			$("#showFeedBack").css("display","none");
			$('#showReply').css("display","block");
		
		 }
		 var vm=new Vue({
				el:'#findInformation',
				data:{
					information:{},
					feedBack:{},
					content:{},
					feedBackMessage:'',
					feedBackAdmin:'',
					iType:'',
                    infos:[],
                    user:[]

					
				},
				methods:{
					fM:function(){
						console.log(this.feedMessage);
						
						
					/* 	axios({
	    					  url:'../../changePwd.action',
	    					  method: 'post',
	    					  responseType: 'text', 
	    					  params:{
	    						  op:'addMessage',
	    						  nickname: this.nickname,
	    						  vName:this.vName,
	    						  vPwd:this.vPwd,
	    						  Introduce:this.Introduce,
	    						  vID:this.vID
	    					  }
	    					}).then(res => {
	    					  console.log('请求结果：', res);
	    					  if(res.data==""){
	    						  alert("你真的添加了吗");
	    					  }
	    					}) */
	    					
	    					
						
					},
					getFeedBack:function(index){
						this.content=this.feedBack[index];
						$("#showFeedBack").css("display","block");
						console.log(this.content)
						
					},
                    showInfo:function(index){
                        this.information=this.infos[index];
                        $("#showInfos").css("display","block");

                    },
					fA:function(){
						console.log(this.feedAdmin);
							iType= this.iType;
						  	iAdvice=this.feedBackAdmin;
						 if(!iType||!iAdvice){
   						 		 alert("添加失败");
   						 		 return;
	   					  }else{
	   						axios({
		    					  url:'../../info/addinfo',
		    					  method: 'post',
		    					  responseType: 'text', 
		    					  params:{
		    						  iType:this.iType,
		    						  iAdvice:this.feedBackAdmin,
		    					  }
		    					}).then(res => {
		    					  console.log('请求结果：', res);
		    					  alert("添加成功");
		    					})
		    					
	   					  }
	   							 
					},
					sendReply:function(){
							fid=this.content.fid;
							message=$("#forLetterArea").val();
							console.log(fid);
							console.log(message);
							axios({
		    					  url:'../../message.action',
		    					  method: 'post',
		    					  responseType: 'text', 
		    					  params:{
		    						  op:'addMessage',
		    						  fid:fid,
		    						  message:message,
		    					  }
		    					}).then(res => {
			    					if(res.data){
			    						alert("发送成功");
			    						$('#showReply').css("display","none");
			    					}else{
			    						alert("发送失败");
			    					}
		    					})
							
						},
				},
				mounted:function(){
					axios.all([getFeedBack(),getInformation(),checkLogin()])
					.then(axios.spread((fn1,fn2,fn3)=>{
						/*this.hot=fn1.data;
						this.main=fn2.data;
						console.log(this.hot);
						console.log(this.main);
						*/
                        if(fn3.data.obj==null){
                            window.location.href="../login.html";
                        }
                        this.user=fn3.data.obj;
						// this.informationInfos=fn2.data.informationInfos;
						this.feedBack=fn1.data.obj;
                        this.infos=fn2.data.obj;
						console.log(fn2.data);
						
					}));
				}
				
			});

			function getFeedBack(){
				return axios.get('../../feedback/getFeedBackAdmin');
			}
			function getInformation(){
				return axios.get('../../info/getInfo');
			}
             function checkLogin(){
                 return axios.get('../../admin/checkLogin');
             }
		</script> 

    </body>
</html>